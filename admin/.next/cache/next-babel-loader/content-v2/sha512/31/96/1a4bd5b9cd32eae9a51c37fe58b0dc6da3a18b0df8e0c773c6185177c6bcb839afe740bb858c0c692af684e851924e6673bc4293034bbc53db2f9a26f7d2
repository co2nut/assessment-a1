{"ast":null,"code":"var _jsxFileName = \"/Users/soonsionglim/Development/etern/admin/pages/users/index.js\";\nimport React from \"react\";\nvar __jsx = React.createElement;\nimport { useEffect, useState } from 'react';\nimport Head from 'next/head';\nimport { useRouter } from 'next/router';\nimport { Modal, Layout, Card, Row, Col, Input, Button } from 'antd';\nimport SideBar from '../../components/SideBar';\nimport Cookie from \"js-cookie\";\nimport { parseCookies } from \"../../lib/parseCookies\";\nimport { Table, Space } from 'antd';\nimport Link from 'next/link';\nimport _ from 'lodash';\nimport { API_URL } from '../../api';\nimport axios from 'axios';\nconst {\n  Header,\n  Content\n} = Layout;\n\nconst Index = props => {\n  const {\n    userInfo\n  } = props;\n  const router = useRouter();\n  const {\n    0: data,\n    1: setData\n  } = useState([]);\n  const {\n    0: total,\n    1: setTotal\n  } = useState(0);\n  const {\n    0: limit,\n    1: setLimit\n  } = useState(10);\n  const {\n    0: page,\n    1: setPage\n  } = useState(1);\n  const {\n    0: showDeleteModal,\n    1: setShowDeleteModal\n  } = useState(false);\n  const {\n    0: activeId,\n    1: setActiveId\n  } = useState(null);\n  const {\n    0: typingTimeout,\n    1: setTypingTimeout\n  } = useState(0);\n  const {\n    0: filterUsername,\n    1: setFilterUsername\n  } = useState(\"\");\n  const {\n    0: filterPassword,\n    1: setFilterPassword\n  } = useState(\"\");\n  const {\n    0: sortBy,\n    1: setSortby\n  } = useState({});\n  const {\n    0: selectedRow,\n    1: setSelectedRow\n  } = useState([]);\n  const {\n    0: showTwo,\n    1: setShowTwo\n  } = useState(false);\n\n  const getData = () => {\n    axios.get(`${API_URL}api/users`, {\n      params: {\n        username: filterUsername,\n        password: filterPassword,\n        page,\n        sort: sortBy,\n        limit: 5\n      },\n      headers: {\n        'Authorization': `Bearer ${JSON.parse(userInfo).access_token}`\n      }\n    }).then(res => {\n      console.log(res.data);\n      const {\n        total,\n        data,\n        limit,\n        last_page,\n        page\n      } = res.data;\n      setPage(page);\n      setLimit(limit);\n      setTotal(total);\n      setData(data);\n    }).catch(err => {\n      console.log(err);\n    });\n  };\n\n  useEffect(() => {\n    clearTimeout(typingTimeout);\n    setTypingTimeout(setTimeout(() => {\n      getData();\n    }, 500));\n  }, [filterUsername, filterPassword]);\n  useEffect(() => {\n    console.log({\n      sortBy\n    });\n    getData();\n  }, [page, sortBy]);\n  useEffect(() => {\n    if (!_.isEmpty(selectedRow) && selectedRow[0] != undefined) {\n      setShowTwo(true);\n    } else {\n      setShowTwo(false);\n    }\n  }, [selectedRow]);\n\n  const deleteRec = () => {\n    axios.put(`${API_URL}api/users/${activeId}`, {\n      Status: '2'\n    }, {\n      headers: {\n        'Authorization': `Bearer ${JSON.parse(userInfo).access_token}`\n      }\n    }).then(res => {\n      getData();\n      setShowDeleteModal(false);\n    }).catch(err => {\n      setShowDeleteModal(false);\n      setActiveId(null);\n    });\n  };\n\n  const deleteMulti = () => {\n    selectedRow.map((i, index) => {\n      axios.put(`${API_URL}api/users/${i}`, {\n        Status: '2'\n      }, {\n        headers: {\n          'Authorization': `Bearer ${JSON.parse(userInfo).access_token}`\n        }\n      }).then(() => {\n        getData();\n        setShowDeleteModal(false);\n        setSelectedRow([]);\n      }).catch(err => {\n        setShowDeleteModal(false);\n        setSelectedRow([]);\n      });\n    });\n  };\n\n  const columns = [{\n    title: 'Username',\n    sorter: true,\n    // sorter: {\n    //   compare: (a, b) => a.username - b.username,\n    //   multiple: 1,\n    // },\n    dataIndex: 'username',\n    key: 'username',\n    fixed: 'left',\n    width: '40%'\n  }, {\n    title: \"Password\",\n    dataIndex: 'password',\n    // sorter:true,\n    // sorter: {\n    //   compare: (a, b) => a.password - b.password,\n    //   multiple: 2,\n    // },\n    key: 'password',\n    fixed: 'left',\n    width: '40%'\n  }, {\n    title: 'Action',\n    key: 'action',\n    fixed: 'right',\n    width: '20%',\n    render: (text, record) => __jsx(Space, {\n      size: \"middle\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 148,\n        columnNumber: 9\n      }\n    }, __jsx(\"a\", {\n      onClick: () => router.push('/users/update/' + record.id),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 149,\n        columnNumber: 11\n      }\n    }, \"Update\"), __jsx(\"a\", {\n      onClick: () => {\n        setActiveId(record.id);\n        setShowDeleteModal(true);\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 150,\n        columnNumber: 11\n      }\n    }, \"Delete\"))\n  }];\n\n  function selectRow(record) {\n    const selectedRowKeys = [...selectedRow];\n\n    if (selectedRowKeys.indexOf(record.key) >= 0) {\n      selectedRowKeys.splice(selectedRowKeys.indexOf(record.key), 1);\n    } else {\n      selectedRowKeys.push(record.key);\n    }\n\n    setSelectedRow(selectedRowKeys);\n  }\n\n  function onSelectedRowKeysChange(selectedRowKeys) {\n    setSelectedRow(selectedRowKeys);\n  }\n\n  const rowSelection = {\n    selectedRow,\n    onChange: onSelectedRowKeysChange\n  };\n  return __jsx(React.Fragment, null, __jsx(Head, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 180,\n      columnNumber: 7\n    }\n  }, __jsx(\"title\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 181,\n      columnNumber: 9\n    }\n  }, \"Aneka Auto\"), __jsx(\"meta\", {\n    name: \"og:title\",\n    content: \"Aneka Auto\",\n    key: \"title\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 182,\n      columnNumber: 9\n    }\n  })), __jsx(Layout, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 184,\n      columnNumber: 7\n    }\n  }, __jsx(SideBar, {\n    activeMenu: \"5\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 185,\n      columnNumber: 9\n    }\n  }), __jsx(Layout, {\n    className: \"site-layout\",\n    style: {\n      marginLeft: 150\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 186,\n      columnNumber: 9\n    }\n  }, __jsx(Header, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 187,\n      columnNumber: 11\n    }\n  }), __jsx(Content, {\n    style: {\n      minHeight: '100vh',\n      margin: 10,\n      padding: 20,\n      backgroundColor: '#fff'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 189,\n      columnNumber: 11\n    }\n  }, __jsx(Modal, {\n    title: \"Delete User\",\n    visible: showDeleteModal,\n    onOk: () => !_.isEmpty(selectedRow) && selectedRow[0] != undefined ? deleteMulti() : deleteRec(),\n    onCancel: () => {\n      setShowDeleteModal(false);\n      setActiveId(null);\n    },\n    okText: \"Delete\",\n    cancelText: \"Cancel\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 190,\n      columnNumber: 13\n    }\n  }, __jsx(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 201,\n      columnNumber: 15\n    }\n  }, \"Are you sure ?\")), __jsx(Row, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 203,\n      columnNumber: 13\n    }\n  }, __jsx(Col, {\n    span: 20,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 204,\n      columnNumber: 15\n    }\n  }, __jsx(\"h3\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 205,\n      columnNumber: 17\n    }\n  }, \"Manage Users\")), __jsx(Col, {\n    span: 4,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 207,\n      columnNumber: 15\n    }\n  }, __jsx(Link, {\n    href: \"/users/new\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 208,\n      columnNumber: 17\n    }\n  }, __jsx(\"h3\", {\n    style: {\n      textAlign: 'right'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 208,\n      columnNumber: 41\n    }\n  }, __jsx(\"a\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 208,\n      columnNumber: 73\n    }\n  }, \"Create\"))))), __jsx(Row, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 212,\n      columnNumber: 13\n    }\n  }, __jsx(Col, {\n    span: 24,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 213,\n      columnNumber: 15\n    }\n  }, __jsx(Card, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 214,\n      columnNumber: 17\n    }\n  }, __jsx(Row, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 215,\n      columnNumber: 19\n    }\n  }, __jsx(Col, {\n    style: {\n      margin: 10,\n      marginTop: 15\n    },\n    span: 1,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 216,\n      columnNumber: 21\n    }\n  }, __jsx(\"h4\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 216,\n      columnNumber: 68\n    }\n  }, \"Search\")), __jsx(Col, {\n    span: 4,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 217,\n      columnNumber: 21\n    }\n  }, __jsx(Input, {\n    placeholder: \"Username\",\n    style: {\n      margin: 10,\n      width: \"90%\"\n    },\n    allowClear: true,\n    value: filterUsername,\n    onChange: e => {\n      clearTimeout(typingTimeout), setFilterUsername(e.target.value);\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 217,\n      columnNumber: 35\n    }\n  })), __jsx(Col, {\n    span: 4,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 218,\n      columnNumber: 21\n    }\n  }, __jsx(Input, {\n    placeholder: \"Password\",\n    style: {\n      margin: 10,\n      width: \"90%\"\n    },\n    allowClear: true,\n    value: filterPassword,\n    onChange: e => {\n      clearTimeout(typingTimeout), setFilterPassword(e.target.value);\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 218,\n      columnNumber: 35\n    }\n  }))), showTwo ? __jsx(Button, {\n    type: \"warning\",\n    onClick: () => {\n      setShowDeleteModal(true);\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 220,\n      columnNumber: 28\n    }\n  }, \"Delete\") : null, __jsx(Table, {\n    bordered: true,\n    size: \"small\",\n    rowKey: \"id\",\n    rowSelection: rowSelection,\n    onRow: record => ({\n      onClick: () => {\n        selectRow(record);\n      }\n    }),\n    onChange: (p, f, s) => {\n      if (p) {\n        setPage(p.current);\n      }\n\n      if (s) {\n        if (Array.isArray(s)) {// let sortValue = {}\n          // s.map(i=>{\n          //   const {columnKey, order} = i\n          //   sortValue[columnKey]=order==='ascend'?1:-1\n          // })\n          // setSortby(sortValue)\n        } else {\n          console.log({\n            s\n          });\n          const {\n            columnKey,\n            order\n          } = s;\n          let sortValue = {};\n          sortValue[columnKey] = order === 'ascend' ? 1 : -1;\n          setSortby(sortValue);\n        }\n      }\n    },\n    pagination: {\n      size: \"large\",\n      total: total,\n      showSizeChanger: false,\n      pageSize: limit,\n      defaultCurrent: 1\n    },\n    style: {\n      marginTop: 20\n    },\n    columns: columns,\n    dataSource: data,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 223,\n      columnNumber: 19\n    }\n  }))))))));\n};\n\nexport default Index;\nexport async function getServerSideProps({\n  req\n}) {\n  const cookies = parseCookies(req);\n  return {\n    props: {\n      userInfo: cookies.userInfo\n    }\n  };\n}","map":{"version":3,"sources":["/Users/soonsionglim/Development/etern/admin/pages/users/index.js"],"names":["useEffect","useState","Head","useRouter","Modal","Layout","Card","Row","Col","Input","Button","SideBar","Cookie","parseCookies","Table","Space","Link","_","API_URL","axios","Header","Content","Index","props","userInfo","router","data","setData","total","setTotal","limit","setLimit","page","setPage","showDeleteModal","setShowDeleteModal","activeId","setActiveId","typingTimeout","setTypingTimeout","filterUsername","setFilterUsername","filterPassword","setFilterPassword","sortBy","setSortby","selectedRow","setSelectedRow","showTwo","setShowTwo","getData","get","params","username","password","sort","headers","JSON","parse","access_token","then","res","console","log","last_page","catch","err","clearTimeout","setTimeout","isEmpty","undefined","deleteRec","put","Status","deleteMulti","map","i","index","columns","title","sorter","dataIndex","key","fixed","width","render","text","record","push","id","selectRow","selectedRowKeys","indexOf","splice","onSelectedRowKeysChange","rowSelection","onChange","marginLeft","minHeight","margin","padding","backgroundColor","textAlign","marginTop","e","target","value","onClick","p","f","s","current","Array","isArray","columnKey","order","sortValue","size","showSizeChanger","pageSize","defaultCurrent","getServerSideProps","req","cookies"],"mappings":"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","sourcesContent":["import { useEffect, useState } from 'react'\nimport Head from 'next/head'\nimport { useRouter } from 'next/router'\nimport { Modal, Layout, Card, Row, Col, Input,Button } from 'antd';\nimport SideBar from '../../components/SideBar'\nimport Cookie from \"js-cookie\";\nimport { parseCookies } from \"../../lib/parseCookies\";\nimport { Table, Space } from 'antd';\nimport Link from 'next/link'\nimport _ from 'lodash';\nimport { API_URL } from '../../api'\nimport axios from 'axios';\n\nconst { Header, Content } = Layout;\n\nconst Index = (props) => {\n  const {userInfo} = props\n  const router = useRouter()\n  const [ data, setData ] = useState([])\n  const [ total, setTotal ] = useState(0)\n  const [ limit, setLimit ] = useState(10)\n  const [ page, setPage ] = useState(1)\n  const [ showDeleteModal, setShowDeleteModal ] = useState(false)\n  const [ activeId, setActiveId ] = useState(null)\n\n  const [ typingTimeout, setTypingTimeout ] = useState(0)\n  const [ filterUsername, setFilterUsername ] = useState(\"\")\n  const [ filterPassword, setFilterPassword ] = useState(\"\")\n  const [ sortBy, setSortby ] = useState({})\n  const [ selectedRow,setSelectedRow]=useState([])\n  const [ showTwo,setShowTwo] =useState(false)\n\n  const getData=()=>{\n    axios.get(`${API_URL}api/users`,\n      {\n        params: {\n          username: filterUsername,\n          password: filterPassword,\n          page,\n          sort:sortBy,\n          limit:5,\n        },\n        headers: {\n          'Authorization': `Bearer ${JSON.parse(userInfo).access_token}` \n        }\n      },\n    )\n    .then((res) => {\n      console.log(res.data)\n      const { total, data, limit, last_page, page } = res.data\n      setPage(page)\n      setLimit(limit)\n      setTotal(total)\n      setData(data)\n    })\n    .catch((err) => {\n      console.log(err)\n    })\n  }\n\n  useEffect(()=>{\n    clearTimeout(typingTimeout) \n    setTypingTimeout( setTimeout(() => { getData() }, 500))\n  },[filterUsername, filterPassword])\n\n  useEffect(()=>{\n    console.log({sortBy})\n    getData()\n  },[page, sortBy])\n\n  useEffect(()=>{\n    if(!_.isEmpty(selectedRow) && selectedRow[0]!=undefined){\n      setShowTwo(true)\n\n    }else{\n      setShowTwo(false)\n    }\n  },[selectedRow])\n\n  const deleteRec = () =>{\n    axios.put(`${API_URL}api/users/${activeId}`,\n      { Status:'2' },\n      { headers: {\n          'Authorization': `Bearer ${JSON.parse(userInfo).access_token}`\n      } }\n    )\n    .then((res) => {\n      getData()\n      setShowDeleteModal(false)\n    })\n    .catch((err) => {\n      setShowDeleteModal(false)\n      setActiveId(null)\n    })\n  }\n\n  const deleteMulti=()=>{\n    selectedRow.map((i,index)=>{\n    axios.put(`${API_URL}api/users/${i}`,\n      { Status:'2' },\n      { headers: {\n          'Authorization': `Bearer ${JSON.parse(userInfo).access_token}`\n      } \n    }).then(()=>{\n      getData()\n      setShowDeleteModal(false)\n      setSelectedRow([])\n\n    }).catch((err) => {\n      setShowDeleteModal(false)\n      setSelectedRow([])\n    })\n\n    })\n  }\n\n  const columns = [\n    {\n      title: 'Username',\n      sorter:true,\n      // sorter: {\n      //   compare: (a, b) => a.username - b.username,\n      //   multiple: 1,\n      // },\n      dataIndex: 'username',\n      key: 'username',\n      fixed:'left',\n      width: '40%',\n    },\n    {\n      title: \"Password\",\n      dataIndex: 'password',\n      // sorter:true,\n      // sorter: {\n      //   compare: (a, b) => a.password - b.password,\n      //   multiple: 2,\n      // },\n      key: 'password',\n      fixed:'left',\n      width: '40%',\n    },\n    {\n      title: 'Action',\n      key: 'action',\n      fixed:'right',\n      width: '20%',\n      render: (text, record) => (\n        <Space size=\"middle\">\n          <a onClick={()=>router.push('/users/update/' + record.id)}>Update</a>\n          <a onClick={()=>{\n            setActiveId(record.id) \n            setShowDeleteModal(true)}}>Delete</a>\n        </Space>\n      ),\n    },\n  ];\n\n  function selectRow (record) {\n    const selectedRowKeys = [...selectedRow];\n    if (selectedRowKeys.indexOf(record.key) >= 0) {\n      selectedRowKeys.splice(selectedRowKeys.indexOf(record.key), 1);\n    } else {\n      selectedRowKeys.push(record.key);\n    }\n    setSelectedRow(selectedRowKeys);\n  }\n  \n  function onSelectedRowKeysChange(selectedRowKeys){\n    setSelectedRow(selectedRowKeys);\n  }\n\n  const rowSelection = {\n    selectedRow,\n    onChange: onSelectedRowKeysChange,\n  };\n\n\n  return (\n    <>\n      <Head>\n        <title>Aneka Auto</title>\n        <meta name=\"og:title\" content=\"Aneka Auto\" key=\"title\" />\n      </Head>\n      <Layout>\n        <SideBar activeMenu='5' />\n        <Layout className=\"site-layout\" style={{ marginLeft: 150 }}>\n          <Header >\n          </Header>\n          <Content style={{minHeight:'100vh',margin:10, padding:20, backgroundColor:'#fff'}}>\n            <Modal\n              title=\"Delete User\"\n              visible={showDeleteModal}\n              onOk={()=>!_.isEmpty(selectedRow) && selectedRow[0]!=undefined?deleteMulti():deleteRec()}\n              onCancel={()=>{\n                setShowDeleteModal(false)\n                setActiveId(null) \n              }}\n              okText=\"Delete\"\n              cancelText=\"Cancel\"\n            >\n              <p>Are you sure ?</p>\n            </Modal>\n            <Row>\n              <Col span={20}>\n                <h3>Manage Users</h3>\n              </Col>\n              <Col span={4}>\n                <Link href='/users/new'><h3 style={{textAlign:'right'}}><a>Create</a></h3></Link>\n              </Col>\n            </Row>\n            \n            <Row>\n              <Col span={24}>\n                <Card>\n                  <Row>\n                    <Col style={{margin:10, marginTop:15}}span={1}><h4>Search</h4></Col>\n                    <Col span={4}><Input placeholder=\"Username\" style={{margin:10, width:\"90%\"}} allowClear value={filterUsername} onChange={e=>{ clearTimeout(typingTimeout) ,setFilterUsername(e.target.value) }} /></Col>\n                    <Col span={4}><Input placeholder=\"Password\" style={{margin:10, width:\"90%\"}} allowClear value={filterPassword} onChange={e=>{ clearTimeout(typingTimeout) ,setFilterPassword(e.target.value) }} /></Col>\n                  </Row>\n                  {showTwo?<Button type=\"warning\" onClick={() => {setShowDeleteModal(true) }}>Delete</Button>:null}\n                \n\n                  <Table bordered size=\"small\" rowKey=\"id\"  \n                      rowSelection={rowSelection}\n                      onRow={(record) => ({\n                        onClick: () => {\n                          selectRow(record);\n                        },\n                      })}\n                    onChange={(p, f, s)=>{\n                      if(p){\n                        setPage(p.current)\n                      }\n                      if(s){\n                        if(Array.isArray(s)){\n                          // let sortValue = {}\n                          // s.map(i=>{\n                          //   const {columnKey, order} = i\n                          //   sortValue[columnKey]=order==='ascend'?1:-1\n                          // })\n                          // setSortby(sortValue)\n                        }else{\n                          console.log({s})\n                          const {columnKey, order} = s\n                          let sortValue = {}\n                          sortValue[columnKey]=order==='ascend'?1:-1\n                          setSortby(sortValue)\n                        }\n                      }\n                    }}\n                    pagination={{\n                      size:\"large\",\n                      total:total,\n                      showSizeChanger:false,\n                      pageSize:limit,\n                      defaultCurrent:1\n                    }} style={{marginTop:20}} columns={columns} dataSource={data} />\n                </Card>\n              </Col>\n            </Row>\n          </Content>\n        </Layout>\n      </Layout>\n\n    </>\n  )\n}\n\nexport default Index\n\nexport async function getServerSideProps({req}) {\n  const cookies = parseCookies(req);\n  return {\n    props:{\n      userInfo: cookies.userInfo\n    }\n  }\n}\n"]},"metadata":{},"sourceType":"module"}