{"ast":null,"code":"var _jsxFileName = \"/Users/soonsionglim/Development/etern/admin/pages/ads/index.js\";\nimport React from \"react\";\nvar __jsx = React.createElement;\nimport { useEffect, useState } from 'react';\nimport Head from 'next/head';\nimport { useRouter } from 'next/router';\nimport { Radio, Modal, Layout, Card, Row, Col, Input, Button } from 'antd';\nimport SideBar from '../../components/SideBar';\nimport Cookie from \"js-cookie\";\nimport { parseCookies } from \"../../lib/parseCookies\";\nimport { Table, Space } from 'antd';\nimport Link from 'next/link';\nimport moment from 'moment';\nimport _ from 'lodash';\nimport { API_URL } from '../../api';\nimport axios from 'axios';\nconst {\n  Header,\n  Content\n} = Layout;\n\nconst Index = props => {\n  const {\n    userInfo\n  } = props;\n  const router = useRouter();\n  const {\n    0: data,\n    1: setData\n  } = useState([]);\n  const {\n    0: total,\n    1: setTotal\n  } = useState(0);\n  const {\n    0: limit,\n    1: setLimit\n  } = useState(10);\n  const {\n    0: page,\n    1: setPage\n  } = useState(1);\n  const {\n    0: showDeleteModal,\n    1: setShowDeleteModal\n  } = useState(false);\n  const {\n    0: showFeaturedModal,\n    1: setShowFeaturedModal\n  } = useState(false);\n  const {\n    0: showAlert,\n    1: setShowAlert\n  } = useState(false);\n  const {\n    0: activeId,\n    1: setActiveId\n  } = useState(null);\n  const {\n    0: typeFeatured,\n    1: setTypeFeatured\n  } = useState(null);\n  const {\n    0: typingTimeout,\n    1: setTypingTimeout\n  } = useState(0);\n  const {\n    0: filterS,\n    1: setFilterS\n  } = useState(\"\");\n  const {\n    0: filterCondition,\n    1: setFilterCondition\n  } = useState(\"\");\n  const {\n    0: sortBy,\n    1: setSortby\n  } = useState({\n    createdAt: -1\n  });\n  const {\n    0: selectedRow,\n    1: setSelectedRow\n  } = useState([]);\n  const {\n    0: showTwo,\n    1: setShowTwo\n  } = useState(false);\n  const {\n    0: totalFeatured,\n    1: setTotalFeatured\n  } = useState([]);\n\n  const getData = () => {\n    // console.log('get user',JSON.parse(userInfo).access_token)\n    // let createdBy = ''\n    // if(userInfo.roles.indexOf('user') >=0){\n    //   createdBy = userInfo.id\n    // }\n    // axios.get(`${API_URL}api/ads`, //gofiber\n    console.log(JSON.parse(userInfo));\n    axios.get(`${API_URL}ads`, {\n      params: {\n        s: filterS,\n        condition: filterCondition,\n        page,\n        sort: sortBy,\n        limit: limit,\n        createdBy: props.userData\n      },\n      headers: {\n        'Authorization': `Bearer ${JSON.parse(userInfo).access_token}`\n      }\n    }).then(res => {\n      const {\n        total,\n        data,\n        limit,\n        page\n      } = res.data;\n      console.log({\n        total,\n        data,\n        limit,\n        page\n      });\n      setPage(page);\n      setLimit(limit);\n      setTotal(total);\n      setData(data);\n    }).catch(err => {\n      console.log('1', {\n        err\n      });\n    });\n  };\n\n  const getFeatured = () => {\n    // axios.get(`${API_URL}api/ads`, //gofiber\n    axios.get(`${API_URL}ads`, {\n      params: {\n        featured: '1',\n        limit: 5\n      },\n      headers: {\n        'Authorization': `Bearer ${JSON.parse(userInfo).access_token}`\n      }\n    }).then(res => {\n      if (res.data.total >= 3) {\n        setShowAlert(true);\n      } else {\n        setShowAlert(false);\n      }\n    });\n  };\n\n  useEffect(() => {\n    clearTimeout(typingTimeout);\n    setTypingTimeout(setTimeout(() => {\n      if (page > 1) {\n        return setPage(1);\n      }\n\n      return getData();\n    }, 500));\n  }, [filterS]);\n  useEffect(() => {\n    if (page > 1) {\n      return setPage(1);\n    }\n\n    return getData();\n  }, [filterCondition]);\n  useEffect(() => {\n    getData();\n  }, [page, sortBy]);\n  useEffect(() => {\n    getFeatured();\n  }, []);\n  useEffect(() => {\n    if (!_.isEmpty(selectedRow) && selectedRow[0] != undefined) {\n      setShowTwo(true);\n    } else {\n      setShowTwo(false);\n    }\n  }, [selectedRow]);\n\n  const deleteRec = () => {\n    axios.put(`${API_URL}api/ads/${activeId}`, {\n      Status: '2'\n    }, {\n      headers: {\n        'Authorization': `Bearer ${JSON.parse(userInfo).access_token}`\n      }\n    }).then(res => {\n      getData();\n      setShowDeleteModal(false);\n    }).catch(err => {\n      setShowDeleteModal(false);\n      setActiveId(null);\n    });\n  };\n\n  const deleteMulti = () => {\n    selectedRow.map((i, index) => {\n      axios.put(`${API_URL}api/ads/${i}`, {\n        Status: '2'\n      }, {\n        headers: {\n          'Authorization': `Bearer ${JSON.parse(userInfo).access_token}`\n        }\n      }).then(() => {\n        getData();\n        setShowDeleteModal(false);\n        setSelectedRow([]);\n      }).catch(err => {\n        setShowDeleteModal(false);\n        setSelectedRow([]);\n      });\n    });\n  };\n\n  const applyFeatured = () => {\n    selectedRow.map((i, index) => {\n      axios.put(`${API_URL}api/ads/${i}`, {\n        Featured: '1'\n      }, {\n        headers: {\n          'Authorization': `Bearer ${JSON.parse(userInfo).access_token}`\n        }\n      }).then(() => {\n        setSortby({\n          \"featured\": -1\n        });\n        setShowFeaturedModal(false);\n        getFeatured();\n        setSelectedRow([]);\n      }).catch(err => {\n        setShowFeaturedModal(false);\n        setSelectedRow([]);\n      });\n    });\n  };\n\n  const applyUnFeatured = () => {\n    selectedRow.map((i, index) => {\n      axios.put(`${API_URL}api/ads/${i}`, {\n        Featured: '0'\n      }, {\n        headers: {\n          'Authorization': `Bearer ${JSON.parse(userInfo).access_token}`\n        }\n      }).then(() => {\n        setSortby({\n          \"featured\": -1\n        });\n        setShowFeaturedModal(false);\n        setSelectedRow([]);\n      }).catch(err => {\n        setShowFeaturedModal(false);\n        setSelectedRow([]);\n      });\n    });\n  };\n\n  const columns = [{\n    title: 'Title',\n    sorter: true,\n    dataIndex: 'title',\n    key: 'title',\n    fixed: 'left',\n    width: '20%'\n  }, {\n    title: \"Condition\",\n    dataIndex: 'condition',\n    key: 'condition',\n    fixed: 'left',\n    width: '15%',\n    render: (t, r) => __jsx(React.Fragment, null, t === '0' ? \"RECON\" : \"USED\")\n  }, {\n    title: \"Price\",\n    dataIndex: 'price',\n    key: 'price',\n    fixed: 'right',\n    width: '15%',\n    render: (t, r) => {\n      // console.log({t})\n      return __jsx(\"span\", {\n        style: {\n          textAlign: 'right'\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 234,\n          columnNumber: 17\n        }\n      }, t.toString().replace(/\\B(?=(\\d{3})+(?!\\d))/g, ','));\n    }\n  }, {\n    title: \"Remark\",\n    dataIndex: 'remark',\n    key: 'remark',\n    fixed: 'left',\n    width: '15%'\n  }, {\n    title: \"Created At\",\n    dataIndex: 'createdAt',\n    key: 'createdAt',\n    fixed: 'left',\n    width: '15%',\n    render: (t, r) => __jsx(React.Fragment, null, moment(t).format(\"DD/MM/YYYY hh:m:s\"))\n  }, {\n    title: 'Action',\n    key: 'action',\n    fixed: 'right',\n    width: '20%',\n    render: (text, record) => __jsx(Space, {\n      size: \"middle\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 260,\n        columnNumber: 9\n      }\n    }, __jsx(\"a\", {\n      onClick: () => router.push('/ads/update/' + record.id),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 261,\n        columnNumber: 11\n      }\n    }, \"Edit\"), __jsx(\"a\", {\n      onClick: () => router.push('/ads/bump/' + record.id),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 262,\n        columnNumber: 11\n      }\n    }, \"Bump\"), props.userData == '60ed6becde470b817eb990bc' ? record.featured == '1' ? __jsx(\"a\", {\n      onClick: () => {\n        setActiveId(record.id);\n        setTypeFeatured(1);\n        setShowFeaturedModal(true);\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 263,\n        columnNumber: 76\n      }\n    }, \"UnFeatured\") : __jsx(\"a\", {\n      onClick: () => {\n        setActiveId(record.id);\n        setTypeFeatured(0);\n        setShowFeaturedModal(true);\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 266,\n        columnNumber: 57\n      }\n    }, \"Featured\") : null, __jsx(\"a\", {\n      onClick: () => {\n        setActiveId(record.id);\n        setShowDeleteModal(true);\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 270,\n        columnNumber: 11\n      }\n    }, \"Delete\"))\n  }];\n\n  function selectRow(record) {\n    const selectedRowKeys = [...selectedRow];\n\n    if (selectedRowKeys.indexOf(record.id) >= 0) {\n      selectedRowKeys.splice(selectedRowKeys.indexOf(record.id), 1);\n    } else {\n      selectedRowKeys.push(record.id);\n    }\n\n    setSelectedRow(selectedRowKeys);\n  }\n\n  function onSelectedRowKeysChange(selectedRow) {\n    setSelectedRow(selectedRow);\n  }\n\n  const rowSelection = {\n    selectedRowKeys: selectedRow,\n    onChange: onSelectedRowKeysChange\n  };\n  return __jsx(React.Fragment, null, __jsx(Head, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 299,\n      columnNumber: 7\n    }\n  }, __jsx(\"title\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 300,\n      columnNumber: 9\n    }\n  }, \"Aneka Auto\"), __jsx(\"meta\", {\n    name: \"og:title\",\n    content: \"Aneka Auto\",\n    key: \"title\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 301,\n      columnNumber: 9\n    }\n  })), __jsx(Layout, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 303,\n      columnNumber: 7\n    }\n  }, __jsx(SideBar, {\n    activeMenu: \"2\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 304,\n      columnNumber: 9\n    }\n  }), __jsx(Layout, {\n    className: \"site-layout\",\n    style: {\n      marginLeft: 150\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 305,\n      columnNumber: 9\n    }\n  }, __jsx(Header, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 306,\n      columnNumber: 11\n    }\n  }), __jsx(Content, {\n    style: {\n      minHeight: '100vh',\n      margin: 10,\n      padding: 20,\n      backgroundColor: '#fff'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 308,\n      columnNumber: 11\n    }\n  }, __jsx(Modal, {\n    title: \"Delete Ads\",\n    visible: showDeleteModal,\n    onOk: () => !_.isEmpty(selectedRow) && selectedRow[0] != undefined ? deleteMulti() : deleteRec(),\n    onCancel: () => {\n      setShowDeleteModal(false);\n      setActiveId(null);\n    },\n    okText: \"Delete\",\n    cancelText: \"Cancel\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 309,\n      columnNumber: 13\n    }\n  }, __jsx(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 320,\n      columnNumber: 15\n    }\n  }, \"Are you sure ?\")), __jsx(Modal, {\n    title: typeFeatured == 0 ? \"Select Featured Ads\" : \"Diselect Featured Ads\",\n    visible: showFeaturedModal && !showAlert || showFeaturedModal && typeFeatured == 1,\n    onOk: () => typeFeatured == 0 ? applyFeatured() : applyUnFeatured(),\n    onCancel: () => {\n      setShowFeaturedModal(false);\n      setActiveId(null);\n    },\n    okText: \"Select\",\n    cancelText: \"Cancel\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 322,\n      columnNumber: 13\n    }\n  }, __jsx(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 333,\n      columnNumber: 15\n    }\n  }, \"Are you sure ?\")), __jsx(Modal, {\n    title: \"The featured ads limit to 3 ads only\",\n    visible: showFeaturedModal && showAlert && typeFeatured == 0,\n    onOk: () => {\n      setShowAlert(false);\n      setShowFeaturedModal(false);\n    },\n    onCancel: () => {\n      setShowFeaturedModal(false);\n      setActiveId(null);\n    },\n    okText: \"OK\",\n    cancelText: \"Cancel\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 335,\n      columnNumber: 13\n    }\n  }, __jsx(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 346,\n      columnNumber: 15\n    }\n  }, \"Please unselect featured ads first then ny select another ads to featured ads.\")), __jsx(Row, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 348,\n      columnNumber: 13\n    }\n  }, __jsx(Col, {\n    span: 20,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 349,\n      columnNumber: 15\n    }\n  }, __jsx(\"h3\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 350,\n      columnNumber: 17\n    }\n  }, \"Manage Ads\")), __jsx(Col, {\n    span: 4,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 352,\n      columnNumber: 15\n    }\n  }, __jsx(Link, {\n    href: \"/ads/new\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 353,\n      columnNumber: 17\n    }\n  }, __jsx(\"h3\", {\n    style: {\n      textAlign: 'right'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 353,\n      columnNumber: 39\n    }\n  }, __jsx(\"a\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 353,\n      columnNumber: 71\n    }\n  }, \"Create\"))))), __jsx(Row, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 357,\n      columnNumber: 13\n    }\n  }, __jsx(Col, {\n    span: 24,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 358,\n      columnNumber: 15\n    }\n  }, __jsx(Card, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 359,\n      columnNumber: 17\n    }\n  }, __jsx(Row, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 360,\n      columnNumber: 19\n    }\n  }, __jsx(Col, {\n    span: 8,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 361,\n      columnNumber: 21\n    }\n  }, __jsx(Input, {\n    placeholder: \"Search Here\",\n    style: {\n      margin: 10,\n      width: \"100%\"\n    },\n    allowClear: true,\n    value: filterS,\n    onChange: e => {\n      clearTimeout(typingTimeout), setFilterS(e.target.value);\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 361,\n      columnNumber: 35\n    }\n  }))), __jsx(Row, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 363,\n      columnNumber: 19\n    }\n  }, __jsx(Col, {\n    style: {\n      margin: 10\n    },\n    span: 8,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 364,\n      columnNumber: 21\n    }\n  }, __jsx(Radio.Group, {\n    onChange: e => {\n      setFilterCondition(e.target.value);\n    },\n    defaultValue: \"\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 365,\n      columnNumber: 23\n    }\n  }, __jsx(Radio.Button, {\n    value: \"\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 366,\n      columnNumber: 25\n    }\n  }, \"ALL\"), __jsx(Radio.Button, {\n    value: \"0\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 367,\n      columnNumber: 25\n    }\n  }, \"RECON\"), __jsx(Radio.Button, {\n    value: \"1\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 368,\n      columnNumber: 25\n    }\n  }, \"USED\")))), showTwo ? __jsx(React.Fragment, null, __jsx(Button, {\n    type: \"warning\",\n    onClick: () => {\n      setShowDeleteModal(true);\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 374,\n      columnNumber: 19\n    }\n  }, \"Delete\")) : null, __jsx(Table, {\n    bordered: true,\n    size: \"small\",\n    rowKey: \"id\",\n    rowSelection: rowSelection,\n    onClick: () => {\n      selectRow(record);\n    },\n    onChange: (p, f, s) => {\n      if (p) {\n        setPage(p.current);\n      }\n\n      if (s) {\n        if (Array.isArray(s)) {// let sortValue = {}\n          // s.map(i=>{\n          //   const {columnKey, order} = i\n          //   sortValue[columnKey]=order==='ascend'?1:-1\n          // })\n          // setSortby(sortValue)\n        } else {\n          console.log({\n            s\n          });\n          const {\n            columnKey,\n            order\n          } = s;\n          let sortValue = {};\n          sortValue[columnKey] = order === 'ascend' ? 1 : -1;\n          setSortby(sortValue);\n        }\n      }\n    },\n    pagination: {\n      size: \"large\",\n      total: total,\n      showSizeChanger: false,\n      pageSize: limit,\n      defaultCurrent: 1,\n      current: page\n    },\n    style: {\n      marginTop: 20\n    },\n    columns: columns,\n    dataSource: data,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 380,\n      columnNumber: 19\n    }\n  }))))))));\n};\n\nexport default Index;\nexport async function getServerSideProps({\n  req\n}) {\n  const cookies = parseCookies(req);\n  const id = JSON.parse(parseCookies(req).userInfo).id; // const respond = await axios.get(`${API_URL}api/users/${id}`,{\n  //   headers: {\n  //     'Authorization': `Bearer ${access_token}` \n  //   }\n  // })\n\n  return {\n    props: {\n      userInfo: cookies.userInfo,\n      userData: id || {}\n    }\n  };\n}","map":{"version":3,"sources":["/Users/soonsionglim/Development/etern/admin/pages/ads/index.js"],"names":["useEffect","useState","Head","useRouter","Radio","Modal","Layout","Card","Row","Col","Input","Button","SideBar","Cookie","parseCookies","Table","Space","Link","moment","_","API_URL","axios","Header","Content","Index","props","userInfo","router","data","setData","total","setTotal","limit","setLimit","page","setPage","showDeleteModal","setShowDeleteModal","showFeaturedModal","setShowFeaturedModal","showAlert","setShowAlert","activeId","setActiveId","typeFeatured","setTypeFeatured","typingTimeout","setTypingTimeout","filterS","setFilterS","filterCondition","setFilterCondition","sortBy","setSortby","createdAt","selectedRow","setSelectedRow","showTwo","setShowTwo","totalFeatured","setTotalFeatured","getData","console","log","JSON","parse","get","params","s","condition","sort","createdBy","userData","headers","access_token","then","res","catch","err","getFeatured","featured","clearTimeout","setTimeout","isEmpty","undefined","deleteRec","put","Status","deleteMulti","map","i","index","applyFeatured","Featured","applyUnFeatured","columns","title","sorter","dataIndex","key","fixed","width","render","t","r","textAlign","toString","replace","format","text","record","push","id","selectRow","selectedRowKeys","indexOf","splice","onSelectedRowKeysChange","rowSelection","onChange","marginLeft","minHeight","margin","padding","backgroundColor","e","target","value","p","f","current","Array","isArray","columnKey","order","sortValue","size","showSizeChanger","pageSize","defaultCurrent","marginTop","getServerSideProps","req","cookies"],"mappings":"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","sourcesContent":["import { useEffect, useState } from 'react'\nimport Head from 'next/head'\nimport { useRouter } from 'next/router'\nimport { Radio, Modal, Layout, Card, Row, Col, Input, Button } from 'antd';\nimport SideBar from '../../components/SideBar'\nimport Cookie from \"js-cookie\";\nimport { parseCookies } from \"../../lib/parseCookies\";\nimport { Table, Space } from 'antd';\nimport Link from 'next/link'\nimport moment from 'moment'\nimport _ from 'lodash';\nimport { API_URL } from '../../api'\nimport axios from 'axios';\n\nconst { Header, Content } = Layout;\n\nconst Index = (props) => {\n  const {userInfo} = props\n  const router = useRouter()\n  const [ data, setData ] = useState([])\n  const [ total, setTotal ] = useState(0)\n  const [ limit, setLimit ] = useState(10)\n  const [ page, setPage ] = useState(1)\n  const [ showDeleteModal, setShowDeleteModal ] = useState(false)\n  const [ showFeaturedModal, setShowFeaturedModal ] = useState(false)\n  const [ showAlert,setShowAlert] = useState(false)\n  const [ activeId, setActiveId ] = useState(null)\n  const [ typeFeatured, setTypeFeatured ] = useState(null)\n\n  const [ typingTimeout, setTypingTimeout ] = useState(0)\n  const [ filterS, setFilterS ] = useState(\"\")\n  const [ filterCondition, setFilterCondition ] = useState(\"\")\n  const [ sortBy, setSortby ] = useState({createdAt:-1})\n  const [ selectedRow,setSelectedRow]=useState([])\n  const [ showTwo,setShowTwo] =useState(false)\n  const [ totalFeatured,setTotalFeatured]=useState([])\n\n  const getData=()=>{\n    // console.log('get user',JSON.parse(userInfo).access_token)\n    // let createdBy = ''\n    // if(userInfo.roles.indexOf('user') >=0){\n    //   createdBy = userInfo.id\n    // }\n\n    // axios.get(`${API_URL}api/ads`, //gofiber\n    console.log( JSON.parse(userInfo) )\n    axios.get(`${API_URL}ads`,\n      {\n        params: {\n          s:filterS,\n          condition:filterCondition,\n          page,\n          sort:sortBy,\n          limit:limit,\n          createdBy:props.userData\n        },\n        headers: {\n          'Authorization': `Bearer ${JSON.parse(userInfo).access_token}` \n        }\n      },\n    )\n    .then((res) => {\n      const { total, data, limit, page } = res.data\n      console.log({total, data, limit, page})\n      setPage(page)\n      setLimit(limit)\n      setTotal(total)\n      setData(data)\n    })\n    .catch((err) => {\n      console.log('1', {err})\n    })\n  }\n\n  const getFeatured=()=>{\n    // axios.get(`${API_URL}api/ads`, //gofiber\n    axios.get(`${API_URL}ads`,\n    {\n      params: {\n        featured:'1',\n        limit:5,\n\n      },\n      headers: {\n        'Authorization': `Bearer ${JSON.parse(userInfo).access_token}` \n      }\n    },\n  ).then((res)=>{\n    if(res.data.total>=3){\n      setShowAlert(true)\n    }else{\n      setShowAlert(false)\n    }\n  })\n  }\n\n  useEffect(()=>{\n    clearTimeout(typingTimeout) \n    setTypingTimeout( setTimeout(() => { \n      if(page > 1){\n        return setPage(1)\n       }\n       return getData()\n     }, 500))\n  },[filterS])\n\n  useEffect(()=>{\n    if(page > 1){\n     return setPage(1)\n    }\n    return getData()\n  },[filterCondition])\n\n  useEffect(()=>{\n    getData()\n  },[page, sortBy])\n\n  useEffect(()=>{\n    getFeatured()\n  },[])\n\n  useEffect(()=>{\n    if(!_.isEmpty(selectedRow) && selectedRow[0]!=undefined){\n      setShowTwo(true)\n\n    }else{\n      setShowTwo(false)\n    }\n  },[selectedRow])\n\n  const deleteRec = () =>{\n    axios.put(`${API_URL}api/ads/${activeId}`,\n      { Status:'2' },\n      { headers: {\n          'Authorization': `Bearer ${JSON.parse(userInfo).access_token}`\n      } }\n    )\n    .then((res) => {\n      getData()\n      setShowDeleteModal(false)\n    })\n    .catch((err) => {\n      setShowDeleteModal(false)\n      setActiveId(null)\n    })\n  }\n\n  const deleteMulti=()=>{\n    selectedRow.map((i,index)=>{\n    axios.put(`${API_URL}api/ads/${i}`,\n      { Status:'2' },\n      { headers: {\n          'Authorization': `Bearer ${JSON.parse(userInfo).access_token}`\n      } \n    }).then(()=>{\n      getData()\n      setShowDeleteModal(false)\n      setSelectedRow([])\n\n    }).catch((err) => {\n      setShowDeleteModal(false)\n      setSelectedRow([])\n    })\n\n    })\n  }\n\n  const applyFeatured=()=>{\n    selectedRow.map((i,index)=>{\n      axios.put(`${API_URL}api/ads/${i}`,\n        { Featured:'1' },\n        { headers: {\n            'Authorization': `Bearer ${JSON.parse(userInfo).access_token}`\n        } \n      }).then(()=>{\n        setSortby({\"featured\":-1})\n        setShowFeaturedModal(false)\n        getFeatured()\n        setSelectedRow([])\n      }).catch((err) => {\n        setShowFeaturedModal(false)\n        setSelectedRow([])\n      })\n  \n      })\n  }\n\n  const applyUnFeatured=()=>{\n    selectedRow.map((i,index)=>{\n      axios.put(`${API_URL}api/ads/${i}`,\n        { Featured:'0' },\n        { headers: {\n            'Authorization': `Bearer ${JSON.parse(userInfo).access_token}`\n        } \n      }).then(()=>{\n        setSortby({\"featured\":-1})\n        setShowFeaturedModal(false)\n        setSelectedRow([])\n      }).catch((err) => {\n        setShowFeaturedModal(false)\n        setSelectedRow([])\n      })\n  \n      })\n  }\n\n  const columns = [\n    {\n      title: 'Title',\n      sorter:true,\n      dataIndex: 'title',\n      key: 'title',\n      fixed:'left',\n      width: '20%',\n    },\n    {\n      title: \"Condition\",\n      dataIndex: 'condition',\n      key: 'condition',\n      fixed:'left',\n      width: '15%',\n      render: (t, r) => (\n        <>{t==='0'?\"RECON\":\"USED\"}</>\n      ),\n    },\n    {\n      title: \"Price\",\n      dataIndex: 'price',\n      key: 'price',\n      fixed:'right',\n      width: '15%',\n      render:(t,r) => {\n        // console.log({t})\n        return (<span style={{textAlign:'right'}}>{t.toString().replace(/\\B(?=(\\d{3})+(?!\\d))/g, ',')}</span>)\n      }\n    },\n    {\n      title: \"Remark\",\n      dataIndex: 'remark',\n      key: 'remark',\n      fixed:'left',\n      width: '15%',\n    },\n    {\n      title: \"Created At\",\n      dataIndex: 'createdAt',\n      key: 'createdAt',\n      fixed:'left',\n      width: '15%',\n      render: (t, r) => (\n        <>{moment(t).format(\"DD/MM/YYYY hh:m:s\")}</>\n      ),\n    },\n    {\n      title: 'Action',\n      key: 'action',\n      fixed:'right',\n      width: '20%',\n      render: (text, record) => (\n        <Space size=\"middle\">\n          <a onClick={()=>router.push('/ads/update/' + record.id)}>Edit</a>\n          <a onClick={()=>router.push('/ads/bump/' + record.id)}>Bump</a>\n          {props.userData=='60ed6becde470b817eb990bc'?record.featured=='1'?<a onClick={()=>{\n            setActiveId(record.id) \n            setTypeFeatured(1)\n            setShowFeaturedModal(true)}}>UnFeatured</a>:<a onClick={()=>{\n            setActiveId(record.id) \n            setTypeFeatured(0)\n            setShowFeaturedModal(true)}}>Featured</a>:null}\n          <a onClick={()=>{\n            setActiveId(record.id) \n            setShowDeleteModal(true)}}>Delete</a>\n        </Space>\n      ),\n    },\n  ];\n\n  function selectRow (record) {\n    const selectedRowKeys = [...selectedRow];\n    if (selectedRowKeys.indexOf(record.id) >= 0) {\n      selectedRowKeys.splice(selectedRowKeys.indexOf(record.id), 1);\n    } else {\n      selectedRowKeys.push(record.id);\n    }\n    setSelectedRow(selectedRowKeys);\n  }\n  \n  function onSelectedRowKeysChange(selectedRow){\n\n    setSelectedRow(selectedRow);\n  }\n\n  const rowSelection = {\n    selectedRowKeys:selectedRow,\n    onChange: onSelectedRowKeysChange,\n  };\n  return (\n    <>\n      <Head>\n        <title>Aneka Auto</title>\n        <meta name=\"og:title\" content=\"Aneka Auto\" key=\"title\" />\n      </Head>\n      <Layout>\n        <SideBar activeMenu='2' />\n        <Layout className=\"site-layout\" style={{ marginLeft: 150 }}>\n          <Header >\n          </Header>\n          <Content style={{minHeight:'100vh',margin:10, padding:20, backgroundColor:'#fff'}}>\n            <Modal\n              title=\"Delete Ads\"\n              visible={showDeleteModal}\n              onOk={()=>!_.isEmpty(selectedRow) && selectedRow[0]!=undefined?deleteMulti():deleteRec()}\n              onCancel={()=>{\n                setShowDeleteModal(false)\n                setActiveId(null) \n              }}\n              okText=\"Delete\"\n              cancelText=\"Cancel\"\n            >\n              <p>Are you sure ?</p>\n            </Modal>\n            <Modal\n              title={typeFeatured==0?\"Select Featured Ads\":\"Diselect Featured Ads\"}\n              visible={(showFeaturedModal&& !showAlert) || (showFeaturedModal&& typeFeatured==1)}\n              onOk={()=>typeFeatured==0?applyFeatured():applyUnFeatured()}\n              onCancel={()=>{\n                setShowFeaturedModal(false)\n                setActiveId(null) \n              }}\n              okText=\"Select\"\n              cancelText=\"Cancel\"\n            >\n              <p>Are you sure ?</p>\n            </Modal>\n            <Modal\n              title={\"The featured ads limit to 3 ads only\"}\n              visible={showFeaturedModal && showAlert && typeFeatured==0}\n              onOk={()=>{setShowAlert(false);setShowFeaturedModal(false)}}\n              onCancel={()=>{\n                setShowFeaturedModal(false)\n                setActiveId(null) \n              }}\n              okText=\"OK\"\n              cancelText=\"Cancel\"\n            >\n              <p>Please unselect featured ads first then ny select another ads to featured ads.</p>\n            </Modal>\n            <Row>\n              <Col span={20}>\n                <h3>Manage Ads</h3>\n              </Col>\n              <Col span={4}>\n                <Link href='/ads/new'><h3 style={{textAlign:'right'}}><a>Create</a></h3></Link>\n              </Col>\n            </Row>\n            \n            <Row>\n              <Col span={24}>\n                <Card>\n                  <Row>\n                    <Col span={8}><Input placeholder=\"Search Here\" style={{margin:10, width:\"100%\"}} allowClear value={filterS} onChange={e=>{ clearTimeout(typingTimeout) ,setFilterS(e.target.value) }} /></Col>\n                  </Row>\n                  <Row>\n                    <Col style={{margin:10}} span={8}>\n                      <Radio.Group onChange={(e)=>{setFilterCondition(e.target.value)}} defaultValue=\"\">\n                        <Radio.Button value=\"\">ALL</Radio.Button>\n                        <Radio.Button value=\"0\">RECON</Radio.Button>\n                        <Radio.Button value=\"1\">USED</Radio.Button>\n                      </Radio.Group>\n                    </Col>\n                  </Row>\n                 {showTwo?\n                 <>\n                  <Button type=\"warning\" onClick={() => {setShowDeleteModal(true) }}>Delete</Button> \n                  {/* <Button type=\"warning\" onClick={() => {setShowFeaturedModal(true)}} style={{marginLeft:10}}>Featured</Button> */}\n                 </>\n                 :null}\n                \n\n                  <Table bordered size=\"small\" rowKey=\"id\"  \n                    rowSelection={rowSelection}\n                    onClick={() => {\n                      selectRow(record);\n                    }}\n                    onChange={(p, f, s)=>{\n                      if(p){\n                        setPage(p.current)\n                      }\n                      if(s){\n                        if(Array.isArray(s)){\n                          // let sortValue = {}\n                          // s.map(i=>{\n                          //   const {columnKey, order} = i\n                          //   sortValue[columnKey]=order==='ascend'?1:-1\n                          // })\n                          // setSortby(sortValue)\n                        }else{\n                          console.log({s})\n                          const {columnKey, order} = s\n                          let sortValue = {}\n                          sortValue[columnKey]=order==='ascend'?1:-1\n                          setSortby(sortValue)\n                        }\n                      }\n                    }}\n                    pagination={{\n                      size:\"large\",\n                      total:total,\n                      showSizeChanger:false,\n                      pageSize:limit,\n                      defaultCurrent:1,\n                      current:page\n\n                    }} style={{marginTop:20}} columns={columns} dataSource={data} />\n                </Card>\n              </Col>\n            </Row>\n          </Content>\n        </Layout>\n      </Layout>\n\n    </>\n  )\n}\n\nexport default Index\n\nexport async function getServerSideProps({req}) {\n  const cookies = parseCookies(req);\n  const id =  JSON.parse(parseCookies(req).userInfo).id;\n  // const respond = await axios.get(`${API_URL}api/users/${id}`,{\n  //   headers: {\n  //     'Authorization': `Bearer ${access_token}` \n  //   }\n  // })\n\n  return {\n    props:{\n      userInfo: cookies.userInfo,\n      userData: id || {}\n    }\n  }\n}\n"]},"metadata":{},"sourceType":"module"}