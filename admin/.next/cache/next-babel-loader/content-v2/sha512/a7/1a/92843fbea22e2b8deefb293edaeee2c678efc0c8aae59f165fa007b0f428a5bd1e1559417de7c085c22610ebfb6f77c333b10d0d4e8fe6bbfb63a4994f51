{"ast":null,"code":"var _jsxFileName = \"/Users/soonsionglim/Development/etern/admin/pages/specs/index.js\";\nimport React from \"react\";\nvar __jsx = React.createElement;\nimport { Button, Card, Col, Input, Layout, Modal, Row, Space, Table } from 'antd';\nimport axios from 'axios';\nimport _ from 'lodash';\nimport Head from 'next/head';\nimport Link from 'next/link';\nimport { useRouter } from 'next/router';\nimport { useEffect, useState } from 'react';\nimport { API_URL } from '../../api';\nimport SideBar from '../../components/SideBar';\nimport { parseCookies } from \"../../lib/parseCookies\";\nconst {\n  Header,\n  Content\n} = Layout;\n\nconst Index = props => {\n  const {\n    userInfo\n  } = props;\n  const router = useRouter();\n  const {\n    0: data,\n    1: setData\n  } = useState([]);\n  const {\n    0: total,\n    1: setTotal\n  } = useState(0);\n  const {\n    0: limit,\n    1: setLimit\n  } = useState(5);\n  const {\n    0: page,\n    1: setPage\n  } = useState(1);\n  const {\n    0: showDeleteModal,\n    1: setShowDeleteModal\n  } = useState(false);\n  const {\n    0: activeId,\n    1: setActiveId\n  } = useState(null);\n  const {\n    0: typingTimeout,\n    1: setTypingTimeout\n  } = useState(0);\n  const {\n    0: filterMake,\n    1: setFilterMake\n  } = useState(\"\");\n  const {\n    0: filterModel,\n    1: setFilterModel\n  } = useState(\"\");\n  const {\n    0: filterYear,\n    1: setFilterYear\n  } = useState(\"\");\n  const {\n    0: filterVariant,\n    1: setFilterVariant\n  } = useState(\"\");\n\n  const getData = () => {\n    let skip = page > 1 ? (page - 1) * limit : 0;\n    axios.get(`${API_URL}specs`, {\n      params: {\n        orRegexOr: [{\n          make: filterMake\n        }, {\n          model: filterModel\n        }, {\n          year: filterYear\n        }, {\n          variant: filterVariant\n        }],\n        $skip: skip,\n        $limit: limit\n      },\n      headers: {\n        'Authorization': `Bearer ${JSON.parse(userInfo).accessToken}`\n      }\n    }).then(res => {\n      const {\n        total,\n        data\n      } = res.data;\n      console.log({\n        total\n      });\n      setTotal(total);\n      setData(data);\n    }).catch(err => {\n      console.log(err);\n    });\n  };\n\n  useEffect(() => {\n    clearTimeout(typingTimeout);\n    setTypingTimeout(setTimeout(() => {\n      getData();\n    }, 500));\n  }, [filterMake, filterModel, filterYear, filterVariant]);\n  useEffect(() => {\n    getData();\n  }, [page]);\n\n  const deleteRec = () => {\n    axios.put(`${API_URL}specs/${activeId}`, {\n      Status: '2'\n    }, {\n      headers: {\n        'Authorization': `Bearer ${JSON.parse(userInfo).accessToken}`\n      }\n    }).then(res => {\n      getData();\n      setShowDeleteModal(false);\n    }).catch(err => {\n      setShowDeleteModal(false);\n      setActiveId(null);\n    });\n  };\n\n  const columns = [{\n    title: 'Make',\n    dataIndex: 'make',\n    key: 'make',\n    fixed: 'left',\n    width: '20%'\n  }, {\n    title: \"Model\",\n    dataIndex: 'model',\n    key: 'model',\n    fixed: 'left',\n    width: '20%'\n  }, {\n    title: \"Year\",\n    dataIndex: 'year',\n    key: 'year',\n    fixed: 'left',\n    width: '20%'\n  }, {\n    title: \"Variant\",\n    dataIndex: 'variant',\n    key: 'variant',\n    fixed: 'left',\n    width: '20%'\n  }, {\n    title: 'Action',\n    key: 'action',\n    fixed: 'right',\n    width: '20%',\n    render: (text, record) => __jsx(Space, {\n      size: \"middle\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 122,\n        columnNumber: 9\n      }\n    }, __jsx(\"a\", {\n      onClick: () => router.push('/specs/update/' + record._id),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 123,\n        columnNumber: 11\n      }\n    }, \"Edit\"), __jsx(\"a\", {\n      onClick: () => {\n        setActiveId(record._id);\n        setShowDeleteModal(true);\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 124,\n        columnNumber: 11\n      }\n    }, \"Delete\"))\n  }];\n  return __jsx(React.Fragment, null, __jsx(Head, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 134,\n      columnNumber: 7\n    }\n  }, __jsx(\"title\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 135,\n      columnNumber: 9\n    }\n  }, \"Car CMS\"), __jsx(\"meta\", {\n    name: \"og:title\",\n    content: \"Aneka Auto\",\n    key: \"title\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 136,\n      columnNumber: 9\n    }\n  })), __jsx(Layout, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 138,\n      columnNumber: 7\n    }\n  }, __jsx(SideBar, {\n    activeMenu: \"3\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 139,\n      columnNumber: 9\n    }\n  }), __jsx(Layout, {\n    className: \"site-layout\",\n    style: {\n      marginLeft: 150\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 140,\n      columnNumber: 9\n    }\n  }, __jsx(Header, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 141,\n      columnNumber: 11\n    }\n  }), __jsx(Content, {\n    style: {\n      minHeight: '100vh',\n      margin: 10,\n      padding: 20,\n      backgroundColor: '#fff'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 143,\n      columnNumber: 11\n    }\n  }, __jsx(Modal, {\n    title: \"Delete Model\",\n    visible: showDeleteModal,\n    onCancel: () => {\n      setShowDeleteModal(false);\n      setActiveId(null);\n    },\n    okText: \"Delete\",\n    cancelText: \"Cancel\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 144,\n      columnNumber: 13\n    }\n  }, __jsx(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 154,\n      columnNumber: 15\n    }\n  }, \"Are you sure ?\")), __jsx(Row, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 156,\n      columnNumber: 13\n    }\n  }, __jsx(Col, {\n    span: 20,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 157,\n      columnNumber: 15\n    }\n  }, __jsx(\"h3\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 158,\n      columnNumber: 17\n    }\n  }, \"Manage Models\")), __jsx(Col, {\n    span: 4,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 160,\n      columnNumber: 15\n    }\n  }, __jsx(Link, {\n    href: \"/specs/new\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 161,\n      columnNumber: 17\n    }\n  }, __jsx(\"h3\", {\n    style: {\n      textAlign: 'right'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 161,\n      columnNumber: 41\n    }\n  }, __jsx(\"a\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 161,\n      columnNumber: 73\n    }\n  }, \"Create\"))))), __jsx(Row, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 165,\n      columnNumber: 13\n    }\n  }, __jsx(Col, {\n    span: 24,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 166,\n      columnNumber: 15\n    }\n  }, __jsx(Card, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 167,\n      columnNumber: 17\n    }\n  }, __jsx(Row, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 168,\n      columnNumber: 19\n    }\n  }, __jsx(Col, {\n    style: {\n      margin: 10,\n      marginTop: 15\n    },\n    span: 1,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 169,\n      columnNumber: 21\n    }\n  }, __jsx(\"h4\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 169,\n      columnNumber: 68\n    }\n  }, \"Search\")), __jsx(Col, {\n    span: 4,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 170,\n      columnNumber: 21\n    }\n  }, __jsx(Input, {\n    placeholder: \"Make\",\n    style: {\n      margin: 10,\n      width: \"90%\"\n    },\n    allowClear: true,\n    value: filterMake,\n    onChange: e => {\n      clearTimeout(typingTimeout), setFilterMake(e.target.value);\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 170,\n      columnNumber: 35\n    }\n  })), __jsx(Col, {\n    span: 4,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 171,\n      columnNumber: 21\n    }\n  }, __jsx(Input, {\n    placeholder: \"Model\",\n    style: {\n      margin: 10,\n      width: \"90%\"\n    },\n    allowClear: true,\n    value: filterModel,\n    onChange: e => {\n      clearTimeout(typingTimeout), setFilterModel(e.target.value);\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 171,\n      columnNumber: 35\n    }\n  })), __jsx(Col, {\n    span: 4,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 172,\n      columnNumber: 21\n    }\n  }, __jsx(Input, {\n    placeholder: \"Year\",\n    style: {\n      margin: 10,\n      width: \"90%\"\n    },\n    allowClear: true,\n    value: filterYear,\n    onChange: e => {\n      clearTimeout(typingTimeout), setFilterYear(e.target.value);\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 172,\n      columnNumber: 35\n    }\n  })), __jsx(Col, {\n    span: 4,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 173,\n      columnNumber: 21\n    }\n  }, __jsx(Input, {\n    placeholder: \"Variant\",\n    style: {\n      margin: 10,\n      width: \"90%\"\n    },\n    allowClear: true,\n    value: filterVariant,\n    onChange: e => {\n      clearTimeout(typingTimeout), setFilterVariant(e.target.value);\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 173,\n      columnNumber: 35\n    }\n  }))), __jsx(Table, {\n    bordered: true,\n    size: \"small\",\n    rowKey: \"id\",\n    onChange: (p, f, s) => {\n      if (p) {\n        setPage(p.current);\n      }\n    },\n    pagination: {\n      size: \"large\",\n      total: total,\n      showSizeChanger: false,\n      pageSize: limit,\n      defaultCurrent: 1\n    },\n    style: {\n      marginTop: 20\n    },\n    columns: columns,\n    dataSource: data,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 175,\n      columnNumber: 19\n    }\n  }))))))));\n};\n\nexport default Index;\nexport async function getServerSideProps({\n  req\n}) {\n  const cookies = parseCookies(req);\n  return {\n    props: {\n      userInfo: cookies.userInfo\n    }\n  };\n}","map":{"version":3,"sources":["/Users/soonsionglim/Development/etern/admin/pages/specs/index.js"],"names":["Button","Card","Col","Input","Layout","Modal","Row","Space","Table","axios","_","Head","Link","useRouter","useEffect","useState","API_URL","SideBar","parseCookies","Header","Content","Index","props","userInfo","router","data","setData","total","setTotal","limit","setLimit","page","setPage","showDeleteModal","setShowDeleteModal","activeId","setActiveId","typingTimeout","setTypingTimeout","filterMake","setFilterMake","filterModel","setFilterModel","filterYear","setFilterYear","filterVariant","setFilterVariant","getData","skip","get","params","orRegexOr","make","model","year","variant","$skip","$limit","headers","JSON","parse","accessToken","then","res","console","log","catch","err","clearTimeout","setTimeout","deleteRec","put","Status","columns","title","dataIndex","key","fixed","width","render","text","record","push","_id","marginLeft","minHeight","margin","padding","backgroundColor","textAlign","marginTop","e","target","value","p","f","s","current","size","showSizeChanger","pageSize","defaultCurrent","getServerSideProps","req","cookies"],"mappings":"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","sourcesContent":["import { Button, Card, Col, Input, Layout, Modal, Row, Space, Table } from 'antd';\nimport axios from 'axios';\nimport _ from 'lodash';\nimport Head from 'next/head';\nimport Link from 'next/link';\nimport { useRouter } from 'next/router';\nimport { useEffect, useState } from 'react';\nimport { API_URL } from '../../api';\nimport SideBar from '../../components/SideBar';\nimport { parseCookies } from \"../../lib/parseCookies\";\n\nconst { Header, Content } = Layout;\n\nconst Index = (props) => {\n  const {userInfo} = props\n  const router = useRouter()\n  const [ data, setData ] = useState([])\n  const [ total, setTotal ] = useState(0)\n  const [ limit, setLimit ] = useState(5)\n  const [ page, setPage ] = useState(1)\n  const [ showDeleteModal, setShowDeleteModal ] = useState(false)\n  const [ activeId, setActiveId ] = useState(null)\n\n  const [ typingTimeout, setTypingTimeout ] = useState(0)\n  const [ filterMake, setFilterMake ] = useState(\"\")\n  const [ filterModel, setFilterModel ] = useState(\"\")\n  const [ filterYear, setFilterYear ] = useState(\"\")\n  const [ filterVariant, setFilterVariant ] = useState(\"\")\n\n  const getData=()=>{\n    let skip = page>1?((page-1)*limit):0\n\n    axios.get(`${API_URL}specs`,\n      {\n        params: {\n          orRegexOr:[\n            { make: filterMake },\n            { model: filterModel },\n            { year: filterYear } ,\n            { variant: filterVariant } ,\n          ],\n          $skip:skip,\n          $limit:limit,\n        },\n        headers: {\n          'Authorization': `Bearer ${JSON.parse(userInfo).accessToken}` \n        }\n      },\n    )\n    .then((res) => {\n      const { total, data } = res.data\n      console.log({total})\n      setTotal(total)\n      setData(data)\n    })\n    .catch((err) => {\n      console.log(err)\n    })\n  }\n\n  useEffect(()=>{\n    clearTimeout(typingTimeout) \n    setTypingTimeout( setTimeout(() => { getData() }, 500))\n  },[filterMake, filterModel, filterYear, filterVariant])\n\n  useEffect(()=>{\n    getData()\n  },[page])\n\n  const deleteRec = () =>{\n    axios.put(`${API_URL}specs/${activeId}`,\n      { Status:'2' },\n      { headers: {\n          'Authorization': `Bearer ${JSON.parse(userInfo).accessToken}`\n      } }\n    )\n    .then((res) => {\n      getData()\n      setShowDeleteModal(false)\n    })\n    .catch((err) => {\n      setShowDeleteModal(false)\n      setActiveId(null)\n    })\n  }\n\n  const columns = [\n    {\n      title: 'Make',\n      dataIndex: 'make',\n      key: 'make',\n      fixed:'left',\n      width: '20%',\n    },\n    {\n      title: \"Model\",\n      dataIndex: 'model',\n      key: 'model',\n      fixed:'left',\n      width: '20%',\n    },\n    {\n      title: \"Year\",\n      dataIndex: 'year',\n      key: 'year',\n      fixed:'left',\n      width: '20%',\n    },\n    {\n      title: \"Variant\",\n      dataIndex: 'variant',\n      key: 'variant',\n      fixed:'left',\n      width: '20%',\n    },\n    {\n      title: 'Action',\n      key: 'action',\n      fixed:'right',\n      width: '20%',\n      render: (text, record) => (\n        <Space size=\"middle\">\n          <a onClick={()=>router.push('/specs/update/' + record._id)}>Edit</a>\n          <a onClick={()=>{\n            setActiveId(record._id) \n            setShowDeleteModal(true)}}>Delete</a>\n        </Space>\n      ),\n    },\n  ];\n\n  return (\n    <>\n      <Head>\n        <title>Car CMS</title>\n        <meta name=\"og:title\" content=\"Aneka Auto\" key=\"title\" />\n      </Head>\n      <Layout>\n        <SideBar activeMenu='3' />\n        <Layout className=\"site-layout\" style={{ marginLeft: 150 }}>\n          <Header >\n          </Header>\n          <Content style={{minHeight:'100vh',margin:10, padding:20, backgroundColor:'#fff'}}>\n            <Modal\n              title=\"Delete Model\"\n              visible={showDeleteModal}\n              onCancel={()=>{\n                setShowDeleteModal(false)\n                setActiveId(null) \n              }}\n              okText=\"Delete\"\n              cancelText=\"Cancel\"\n            >\n              <p>Are you sure ?</p>\n            </Modal>\n            <Row>\n              <Col span={20}>\n                <h3>Manage Models</h3>\n              </Col>\n              <Col span={4}>\n                <Link href='/specs/new'><h3 style={{textAlign:'right'}}><a>Create</a></h3></Link>\n              </Col>\n            </Row>\n            \n            <Row>\n              <Col span={24}>\n                <Card>\n                  <Row>\n                    <Col style={{margin:10, marginTop:15}}span={1}><h4>Search</h4></Col>\n                    <Col span={4}><Input placeholder=\"Make\" style={{margin:10, width:\"90%\"}} allowClear value={filterMake} onChange={e=>{ clearTimeout(typingTimeout) ,setFilterMake(e.target.value) }} /></Col>\n                    <Col span={4}><Input placeholder=\"Model\" style={{margin:10, width:\"90%\"}} allowClear value={filterModel} onChange={e=>{ clearTimeout(typingTimeout) ,setFilterModel(e.target.value) }} /></Col>\n                    <Col span={4}><Input placeholder=\"Year\" style={{margin:10, width:\"90%\"}} allowClear value={filterYear} onChange={e=>{ clearTimeout(typingTimeout) ,setFilterYear(e.target.value) }} /></Col>\n                    <Col span={4}><Input placeholder=\"Variant\" style={{margin:10, width:\"90%\"}} allowClear value={filterVariant} onChange={e=>{ clearTimeout(typingTimeout) ,setFilterVariant(e.target.value) }} /></Col>\n                  </Row>\n                  <Table bordered size=\"small\" rowKey=\"id\"  \n                    onChange={(p, f, s)=>{\n                      if(p){\n                        setPage(p.current)\n                      }\n                    }}\n                    pagination={{\n                      size:\"large\",\n                      total:total,\n                      showSizeChanger:false,\n                      pageSize:limit,\n                      defaultCurrent:1\n                    }} style={{marginTop:20}} columns={columns} dataSource={data} />\n                </Card>\n              </Col>\n            </Row>\n          </Content>\n        </Layout>\n      </Layout>\n\n    </>\n  )\n}\n\nexport default Index\n\nexport async function getServerSideProps({req}) {\n  const cookies = parseCookies(req);\n  return {\n    props:{\n      userInfo: cookies.userInfo\n    }\n  }\n}\n"]},"metadata":{},"sourceType":"module"}